{% extends 'base.html' %}
{% load static %}
{% load thumbnail %}


{% block content %}

<h2 style="text-align: center; position: relative; top: 5em;">
    <b>
        {% if request.user.is_authenticated %}
        Hello {{request.user.username}} : 
        <a href="{% url 'friend_list' %}" style="text-decoration: none; color: rgb(255, 95, 2);"> My Chat List</a> 
        <span id = 'overall_unread' class="w3-badge w3-large w3-green w3-margin-right">{{unread_msg}}</span>
        {% else %}
        Login Required : <a href="/api_auth/login/">Login</a>{% endif %}
    </b>

    <br/>
    <a href="{% url 'create_friend' %}" style="text-decoration: none; color: rgb(255, 188, 2);"><h4>ðŸ”€Add Friend in chat listðŸ”€</h4></a>
</h2>
    
{% endblock %}

{% block script %}

    <script>
        PersonalSocket.onmessage = (e) => {
            const data = JSON.parse(e.data);
            if (data.msg_type === 'MESSAGE_COUNTER') {
                document.getElementById("overall_unread").textContent = data.overall_unread_msg
            }
        }
    </script>

{% endblock %}